{"id": "chatcmpl-cgc5w8l1vl6l2qnubrbvsk", "object": "chat.completion", "created": 1689764898, "model": "/Users/blm/.cache/lm-studio/models/TheBloke/WizardCoder-15B-1.0-GGML/WizardCoder-15B-1.0.ggmlv3.q4_0.bin", "choices": [{"index": 0, "message": {"role": "assistant", "content": "import openpyxl\n\ndef read_spreadsheet(file_path):\n    \"\"\"\n    This function reads data from a spreadsheet file and returns a list of dictionaries.\n    Each dictionary contains data for a single row in the spreadsheet.\n    The first row of the spreadsheet is considered as the header row.\n    The first column of the spreadsheet is considered as the index column.\n    The index column is used as the key for each dictionary.\n    \"\"\"\n    # Open the workbook and get the active worksheet\n    workbook = openpyxl.load_workbook(file_path)\n    worksheet = workbook.active\n\n    # Get the header row and index column values\n    header_row = next(worksheet.iter_rows())\n    index_column = next(header_row)[0].value\n\n    # Create a list to store the data\n    data = []\n\n    # Iterate over each row in the worksheet and create a dictionary for each row\n    for row in worksheet.iter_rows(min_row=2):\n        row_data = {}\n        for i, cell in enumerate(row):\n            header = header_row[i].value\n            row_data[header] = cell.value\n        data.append(row_data)\n\n    # Create a dictionary with the data indexed by the index column value\n    indexed_data = {}\n    for row in data:\n        indexed_data[row[index_column]] = row\n\n    return indexed_data\n\n# Example usage\nfile_path = \"example.xlsx\"\ndata = read_spreadsheet(file_path)\nprint(data)\n\n# Output:\n# {\n#     \"1\": {\"Name\": \"John\", \"Age\": 30, \"City\": \"New York\"},\n#     \"2\": {\"Name\": \"Jane\", \"Age\": 25, \"City\": \"Los Angeles\"},\n#     \"3\": {\"Name\": \"Bob\", \"Age\": 40, \"City\": \"Chicago\"}\n# } }"}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 0, "completion_tokens": 415, "total_tokens": 415}, "time": "71.76"}